<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/**
 * Product description template
 *
 * @see Mage_Catalog_Block_Product_View_Description
 */
?>
<?php $_description = $this->getProduct()->getDescription(); ?>

<?php if ($_description): ?>
	<div class="product-description">
		<h3><?php echo $this->__('Product description') ?></h3>

		<div class="std comment more">
			<?php echo $this->helper('catalog/output')->productAttribute($this->getProduct(), $_description, 'description') ?>
		</div>
	</div>
<?php endif; ?>

<style>
	a.morelink {
		text-decoration:none;
		outline: none;
	}
	.morecontent span {
		display: none;
	}
	.comment {
		width: 400px;
		max-width: 100%;;
	}
</style>

<script>
	jQuery(document).ready(function () {
		var showChar = 700;
		var ellipsestext = "...";
		var moretext = "veja mais";
		var lesstext = "menos";
		jQuery('.more').each(function () {
			var content = jQuery(this).html();

			if (content.length > showChar) {

				var c = content.substr(0, showChar);
				var h = content.substr(showChar - 1, content.length - showChar);

				var html = c + '<span class="moreellipses">' + ellipsestext + '&nbsp;</span><span class="morecontent"><span>' + h + '</span>&nbsp;&nbsp;<a href="" class="morelink">' + moretext + '</a></span>';

				jQuery(this).html(html);
			}

		});

		jQuery(".morelink").click(function () {
			if (jQuery(this).hasClass("less")) {
				jQuery(this).removeClass("less");
				jQuery(this).html(moretext);
			} else {
				jQuery(this).addClass("less");
				jQuery(this).html(lesstext);
			}
			jQuery(this).parent().prev().toggle();
			jQuery(this).prev().toggle();

			if (!jQuery(this).hasClass("less")) {
				jQuery("html, body").scrollTop(0);
			}

			return false;
		});
	});
</script>
