<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
$_element = $this->getElement();
$_note    = $_element->getNote();
$_trId    = $_element->getHtmlContainerId();
$_class   = $_element->getFieldsetHtmlClass();
?>

<?php if(Mage::app()->getRequest()->getControllerName() == 'sales_order_status'){ ?>

	<?php $userType	= ''; ?>
	<?php if($userModel = Mage::getSingleton('admin/session')){ ?>
		<?php $userType	= $userModel->getUser()->getUsertype(); ?>
	<?php } ?>		
			
		<?php if($userType != NULL){ ?>	
				
			<?php $userObj 			= new Int_Advancedpermissions_Block_Catalog_Product_Grid(); ?>
			<?php $userWebsite 		= $userObj->getCurrentUserWebsite(); ?>
			<?php $userStore 		= $userObj->getCurrentUserStore(); ?>
			<?php $userStoreView	= $userObj->getCurrentUserStoreView(); ?>
			
			<?php 
				$_userWebsite = '';
				foreach ($userWebsite as $website){
						$_userWebsite[] = 'w_'.$website.'_label';	
					
				}
			?>
			
			<?php 
				$_userStore = '';
				foreach ($userStore as $store){
						$_userStore[] = 'sg_'.$store.'_label';	
					
			}
			?>
			
			<?php 
				$_userStoreView = '';
				foreach ($userStoreView as $storeView){
						$_userStoreView[] = 'store_label_'.$storeView;	
					
				}
			?>
			
		<?php $arrMerge = array_merge(array('label'), $_userWebsite, $_userStore, $_userStoreView); ?>
	
		<?php if(in_array($_element->getId(), $arrMerge)){ ?>
			<?php if (!$_element->getNoDisplay()): ?>
			<tr<?php if($_trId): ?> id="<?php echo $_trId ?>"<?php endif; ?>>
			    <?php if ($_element->getType()=='hidden'): ?>
			    <td colspan="2" class="hidden"><?php echo trim($_element->getElementHtml()) ?></td>
			    <?php else: ?>
			    <td class="label<?php echo $_class ? " {$_class}-label" : ''?>"><?php echo trim($_element->getLabelHtml()) ?></td>
			    <td class="<?php echo $_element->hasValueClass() ? $_element->getValueClass() : 'value' ?><?php echo $_class ? " {$_class}-value" : ''?>">
			        <?php echo trim($_element->getElementHtml()) ?>
			        <?php if ($_note): ?>
			            <p class="note<?php echo $_class ? " {$_class}-note" : ''?>" id="note_<?php echo $_element->getId()?>"><span><?php echo $_note ?></span></p>
			        <?php endif ?>
			    </td>
			    <?php endif; ?>
			</tr>
			<?php endif; ?>
			
		<?php } ?>
	
	<?php } else { ?>
	
	
		<?php if (!$_element->getNoDisplay()): ?>
		<tr<?php if($_trId): ?> id="<?php echo $_trId ?>"<?php endif; ?>>
		    <?php if ($_element->getType()=='hidden'): ?>
		    <td colspan="2" class="hidden"><?php echo trim($_element->getElementHtml()) ?></td>
		    <?php else: ?>
		    <td class="label<?php echo $_class ? " {$_class}-label" : ''?>"><?php echo trim($_element->getLabelHtml()) ?></td>
		    <td class="<?php echo $_element->hasValueClass() ? $_element->getValueClass() : 'value' ?><?php echo $_class ? " {$_class}-value" : ''?>">
		        <?php echo trim($_element->getElementHtml()) ?>
		        <?php if ($_note): ?>
		            <p class="note<?php echo $_class ? " {$_class}-note" : ''?>" id="note_<?php echo $_element->getId()?>"><span><?php echo $_note ?></span></p>
		        <?php endif ?>
		    </td>
		    <?php endif; ?>
		</tr>
		<?php endif; ?>
		
	
	<?php } ?>
	
<?php } else { ?>

	<?php if (!$_element->getNoDisplay()): ?>
	<tr<?php if($_trId): ?> id="<?php echo $_trId ?>"<?php endif; ?>>
	    <?php if ($_element->getType()=='hidden'): ?>
	    <td colspan="2" class="hidden"><?php echo trim($_element->getElementHtml()) ?></td>
	    <?php else: ?>
	    <td class="label<?php echo $_class ? " {$_class}-label" : ''?>"><?php echo trim($_element->getLabelHtml()) ?></td>
	    <td class="<?php echo $_element->hasValueClass() ? $_element->getValueClass() : 'value' ?><?php echo $_class ? " {$_class}-value" : ''?>">
	        <?php echo trim($_element->getElementHtml()) ?>
	        <?php if ($_note): ?>
	            <p class="note<?php echo $_class ? " {$_class}-note" : ''?>" id="note_<?php echo $_element->getId()?>"><span><?php echo $_note ?></span></p>
	        <?php endif ?>
	    </td>
	    <?php endif; ?>
	</tr>
	<?php endif; ?>
	
<?php } ?>